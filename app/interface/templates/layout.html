<!doctype html>
<head>
    <!-- Required meta tags -->
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">


    <!-- Bootstrap CSS -->
    <link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/4.0.0/css/bootstrap.min.css" integrity="sha384-Gn5384xqQ1aoWXA+058RXPxPg6fy4IWvTNh0E263XmFcJlSAwiGgFAW/dAiS6JXm" crossorigin="anonymous">
    <link rel="stylesheet" href="static/assets/css/style.css">
    <title>God's Eye</title>

     <!-- Font Awesome JS -->
     <script defer src="https://use.fontawesome.com/releases/v5.0.13/js/solid.js" integrity="sha384-tzzSw1/Vo+0N5UhStP3bvwWPq+uvzCMfrN1fEFe+xBmv1C/AtVX5K0uZtmcHitFZ" crossorigin="anonymous"></script>
     <script defer src="https://use.fontawesome.com/releases/v5.0.13/js/fontawesome.js" integrity="sha384-6OIrr52G08NpOFSZdxxz1xdNSndlD4vdcf/q2myIUVO0VsqaGHJsB0RaBE01VTOY" crossorigin="anonymous"></script>
</head>
<body>
            <!-- jQuery CDN - Slim version (=without AJAX) -->
            <script src="https://code.jquery.com/jquery-3.3.1.slim.min.js" integrity="sha384-q8i/X+965DzO0rT7abK41JStQIAqVgRVzpbzo5smXKp4YfRvH+8abtTE1Pi6jizo" crossorigin="anonymous"></script>
            <!-- Popper.JS -->
            <script src="https://cdnjs.cloudflare.com/ajax/libs/popper.js/1.14.0/umd/popper.min.js" integrity="sha384-cs/chFZiN24E4KMATLdqdvsezGxaGsi4hLGOzlXwp5UZB1LY//20VyM2taTB4QvJ" crossorigin="anonymous"></script>
            <!-- Bootstrap JS -->
            <script src="https://stackpath.bootstrapcdn.com/bootstrap/4.1.0/js/bootstrap.min.js" integrity="sha384-uefMccjFJAIv6A+rW+L4AHf99KvxDjWSu1z9VI8SKNVmz4sk7buKt/6v9KI65qnm" crossorigin="anonymous"></script> 
            
            <!-- jquery -->
            <script src="jquery-3.5.1.min.js"></script>

            <!-- camera.update() service -->
            <script>
                var camera_manager = new EventSource("/camera_manager");
                camera_manager.onmessage = function(event) {
                    data = event.data.split("&&&");
                    camera_id = data[0];
                    status = data[1];
                    if (status == 'Noooooone') {
                        alert(`Camera ${camera_id} is not responding!`);
                    }


                }
            </script>
            <!-- Device Info Monitoring -->
            <script>
                var device_info = new EventSource("/system_info");
                device_info.onmessage = function(event) {
                    cpu = "#cpu_usage"
                    ram = "#ram_usage"
                    gpu = "#gpu_usage"
                    data = event.data.split("&&&");
                    cpu_usage = data[0]
                    ram_usage = data[1]
                    gpu_usage = data[2]
                    $(cpu).css('width', cpu_usage+'%').attr('aria-valuenow', cpu_usage);
                    $(cpu).text(cpu_usage+'%');
                    $(ram).css('width', ram_usage+'%').attr('aria-valuenow', ram_usage);
                    $(ram).text(ram_usage+'%');
                    $(gpu).css('width', gpu_usage+'%').attr('aria-valuenow', gpu_usage);
                    $(gpu).text(gpu_usage+'%');
                }
            </script>

            <!-- Camera Alert Monitoring -->
            <script>
                var state_monitor = new EventSource("/state_info");
                state_monitor.onmessage = function(event) {
                    data = event.data.split("&&&");
                    camera = data[0];
                    alert_code = data[1];
                    message_template = `Camera ${camera} found a person that `;
                    if (alert_code == 0) {
                        alert_message = message_template + "does not have a badge"
                    } 
                    else if (alert_code == 1) {
                        alert_message = message_template + "is in a restricted area"
                    }
                    else if (alert_code == 2) {
                        alert_message = message_template + "might have a badge but not a valid SBP one"
                    }
                    else {
                        alert_message = "test"
                    };
                    
                    alert(alert_message)
                }
            </script>



            






<div class=wrapper>




          <!-- Sidebar -->
            <nav id="sidebar">
                <div class="sidebar-header">
                    <h3>Badge Detector</h3>
                </div>
        
                <ul class="list-unstyled components">
                    <p>Schuberg Philis</p>
                    <li>
                        <a href="#camerasSubmenu" data-toggle="collapse" aria-expanded="false" class="dropdown-toggle">
                            <i class="fas fa-video"></i>
                            Cameras ({{list_len}})</a>
                        <ul class="collapse list-unstyled" id="camerasSubmenu">
                            {% for idx in range(list_len) %}
                                <li>
                                    <a href="#carousel" data-slide-to={{idx}}>{{camera_list[idx].id}}</a>
                                </li> 
                            {% endfor %}
                        </ul>
                    </li>
                    <li>
                        <a href="#settingsSubmenu" data-toggle="collapse" aria-expanded="false" class="dropdown-toggle">
                            <i class="fas fa-cogs"></i>
                            Settings</a>
                        <ul class="collapse list-unstyled" id="settingsSubmenu">
                            <form action="{{ url_for('update_settings')}}" method="post">
                                <li>
                                        <label for="buffer_range" class="form-label">Buffer size ({{camera_list[0].buffer_size}})</label>
                                        <input type="range" class="form-range" min="1" max="30" step="1" id="buffer_range" name="buffer_range" value="{{camera_list[0].buffer_size}}"/>
                                </li>
                                <li>
                                        <label for="lifetime_range" class="form-label">Object Lifetime ({{camera_list[0].object_lifetime}})</label>
                                        <input type="range" class="form-range" min="1" max="30" step="1" id="lifetime_range" name="lifetime_range" value="{{camera_list[0].object_lifetime}}"/>
                                </li>
                                <li>
                                        <label for="maxcheck_range" class="form-label">Max Badge Check Count ({{camera_list[0].max_badge_check_count}})</label>
                                        <input type="range" class="form-range" min="1" max="15" step="1" id="maxcheck_range" name="maxcheck_range" value="{{camera_list[0].max_badge_check_count}}"/>
                                </li>
                                <li>
                                    <div class="submitbutton-container">
                                    <input type="submit" class="btn btn-primary">
                                    </div>
                                </li>
                            </form>
                    </form>
                        </ul>
                    </li>
                    <li>
                        <a href="#manageCamerasSubmenu" data-toggle="collapse" aria-expanded="false" class="dropdown-toggle">
                            <i class="fas fa-video"></i>
                            Manage Cameras</a>
                            <ul class="collapse list-unstyled" id="manageCamerasSubmenu">
                                <li>
                                    <a href="#addCameraSubmenu" data-toggle="collapse" aria-expanded="false" class="dropdown-toggle">
                                        Add</a>
                                    <ul class="collapse list-unstyled" id="addCameraSubmenu">
                                        <li>
                                            <form action="{{ url_for('add_camera')}}" method="post">
                                                <input type="text" id="addCameraForm_id" name="addCameraForm_id" placeholder="ID/Name" style="color:blue;width:80%;margin-left:10px; border-radius: 5px; margin-top: 10px"><br>  
                                                <input type="text" id="addCameraForm_url" name="addCameraForm_url" placeholder="Path to stream" style="color:blue;width:80%;margin-left:10px; border-radius: 5px; margin-top: 10px"><br>
                                                <li class="allowedBadgesList">
                                                    <input type="checkbox" id="badge_1" name="badge_1" value="1" style="margin-left:10px; margin-top: 10px;">
                                                    <label for="badge_1">Blue</label><br>
                                                    <input type="checkbox" id="badge_2" name="badge_2" value="2"style="margin-left:10px">
                                                    <label for="badge_2">Orange</label><br>
                                                    <input type="checkbox" id="badge_3" name="badge_3" value="3"style="margin-left:10px">
                                                    <label for="badge_3">Green</label><br>
                                                    <input type="checkbox" id="badge_4" name="badge_4" value="4"style="margin-left:10px">
                                                    <label for="badge_4">Dark Blue</label><br>
                                                    <input type="checkbox" id="badge_5" name="badge_5" value="5"style="margin-left:10px">
                                                    <label for="badge_5">Pink</label><br>
                                                </li>
                                                <div class="submitbutton-container">
                                                <button type="submit"  class="btn btn-primary">Add Camera</button> 
                                            </div>                                         
                                            </form>  
                                        </li>
                                    </ul>
                                </li>
                                <li>
                                    <a href="#removeCameraSubmenu" data-toggle="collapse" aria-expanded="false" class="dropdown-toggle">
                                        Remove</a>
                                    <ul class="collapse list-unstyled" id="removeCameraSubmenu">
                                        <li>
                                            <form action="{{ url_for('remove_camera')}}" method="post">
                                                <input type="text" id="removeCameraForm_id" name="removeCameraForm_id" placeholder="ID/Name" style="color:blue;width:80%;margin-left:10px; border-radius: 5px; margin-top: 10px"><br>  
                                                <div class="submitbutton-container">
                                                <button type="submit"  class="btn btn-primary">Remove Camera</button>  
                                                </div>     
                                            </form>
                                        </li>
                                    </ul>
                                </li>
                            </ul>
                    </li>
                    <li>
                        <a href="#systemInfo" data-toggle="collapse" aria-expanded="false" class="dropdown-toggle">
                            <i class="fas fa-video"></i>
                            System Info</a>
                        <ul class="collapse list-unstyled" id="systemInfo">
                            <li>
                                <p>cpu usage</p>
                                <div class="progress" style="width: 95%; margin: 5px;" >
                                    <div class="progress-bar bg-info" role="progressbar" aria-valuenow="0" aria-valuemin="0" aria-valuemax="100" style="width: 0%" id="cpu_usage">
                                        <span class="progress-bar-label" id="cpu_usage_label">0%</span>
                                    </div>
                                </div>
                            </li>
                            <li>
                                <p>ram usage</p>
                                <div class="progress" style="width: 95%; margin: 5px;" >
                                    <div class="progress-bar bg-info" role="progressbar" aria-valuenow="0" aria-valuemin="0" aria-valuemax="100" style="width: 0%" id="ram_usage">
                                        <span class="progress-bar-label" id="ram_usage_label">0%</span>
                                    </div>
                                </div>
                            </li>
                            <li>
                                <p>gpu usage</p>
                                <div class="progress" style="width: 95%; margin: 5px;" >
                                    <div class="progress-bar bg-info" role="progressbar" aria-valuenow="0" aria-valuemin="0" aria-valuemax="100" style="width: 0%" id="gpu_usage">
                                        <span class="progress-bar-label" id="gpu_usage_label">0%</span>
                                    </div>
                                </div>
                            </li>
                        </ul>
                    </li>
                    
                </ul>
            </nav>

                          <!--Content-->


<div id="content">    
    <nav class="navbar navbar-expand-lg ">
          <div class="container-fluid">
        <button type="button" id="sidebarCollapse" class="btn btn-info" >
            <i class="fas fa-align-left"></i>
            <span>Menu</span>
        </button>
        </div>
        
    </nav>

    

    {% block body %}{% endblock %}
</div> 
          


</div>


<!-- Sidebar interactive -->
    <script>$(document).ready(function () {
    
        $('#sidebarCollapse').on('click', function () {
            $('#sidebar').toggleClass('active');
          });
      });</script>

<!-- Sliders -->


        <script>
        var slider = document.getElementById("buffer_range");
        
        slider.onchange = function() {
        newvalue_buffer=this.value;
} 
        </script>

        <script>
        var slider = document.getElementById("lifetime_range");
            
        slider.onchange = function() {
        newvalue_lifetime = this.value;
        }
        </script>

        <script>
        var slider = document.getElementById("mbcc_range");

            
        slider.onchange = function() {
        newvalue_mbcc =this.value;
        }
        </script>

<!-- slider event listener -->

<script>
    document.getElementById("buffer_range").addEventListener("change", function(){
        document.getElementById("buffervalue").innerHTML = newvalue_buffer;
    });
</script>

<script>
    document.getElementById("lifetime_range").addEventListener("change", function(){
        document.getElementById("lifetimevalue").innerHTML = newvalue_lifetime;
    });
</script>
<script>
    document.getElementById("mbcc_range").addEventListener("change", function(){
    document.getElementById("mbccvalue").innerHTML = newvalue_mbcc;
});
</script>








    

</body>
