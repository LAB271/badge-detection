<!doctype html>
<head>
    <!-- Required meta tags -->
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">


    <!-- Bootstrap CSS -->
    <link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/4.0.0/css/bootstrap.min.css" integrity="sha384-Gn5384xqQ1aoWXA+058RXPxPg6fy4IWvTNh0E263XmFcJlSAwiGgFAW/dAiS6JXm" crossorigin="anonymous">
    <link rel="stylesheet" href="static/assets/css/style.css">
    <title>God's Eye</title>

     <!-- Font Awesome JS -->
     <script defer src="https://use.fontawesome.com/releases/v5.0.13/js/solid.js" integrity="sha384-tzzSw1/Vo+0N5UhStP3bvwWPq+uvzCMfrN1fEFe+xBmv1C/AtVX5K0uZtmcHitFZ" crossorigin="anonymous"></script>
     <script defer src="https://use.fontawesome.com/releases/v5.0.13/js/fontawesome.js" integrity="sha384-6OIrr52G08NpOFSZdxxz1xdNSndlD4vdcf/q2myIUVO0VsqaGHJsB0RaBE01VTOY" crossorigin="anonymous"></script>
</head>
<body>
            <!-- jQuery CDN - Slim version (=without AJAX) -->
            <script src="https://code.jquery.com/jquery-3.3.1.slim.min.js" integrity="sha384-q8i/X+965DzO0rT7abK41JStQIAqVgRVzpbzo5smXKp4YfRvH+8abtTE1Pi6jizo" crossorigin="anonymous"></script>
            <!-- Popper.JS -->
            <script src="https://cdnjs.cloudflare.com/ajax/libs/popper.js/1.14.0/umd/popper.min.js" integrity="sha384-cs/chFZiN24E4KMATLdqdvsezGxaGsi4hLGOzlXwp5UZB1LY//20VyM2taTB4QvJ" crossorigin="anonymous"></script>
            <!-- Bootstrap JS -->
            <script src="https://stackpath.bootstrapcdn.com/bootstrap/4.1.0/js/bootstrap.min.js" integrity="sha384-uefMccjFJAIv6A+rW+L4AHf99KvxDjWSu1z9VI8SKNVmz4sk7buKt/6v9KI65qnm" crossorigin="anonymous"></script> 
            
            <!-- jquery -->
            <script src="jquery-3.5.1.min.js"></script>


            <!-- Device Info Monitoring -->
            <script>
                var device_info = new EventSource("/system_info");
                device_info.onmessage = function(event) {
                    cpu = "#cpu_usage"
                    ram = "#ram_usage"
                    cpu_usage = event.data[0]+event.data[1]
                    ram_usage = event.data[4]+event.data[5]
                    $(cpu).css('width', cpu_usage+'%').attr('aria-valuenow', cpu_usage);
                    $(cpu).text(cpu_usage+'%');
                    $(ram).css('width', ram_usage+'%').attr('aria-valuenow', ram_usage);
                    $(ram).text(ram_usage+'%');
                }
            </script>

            <!-- Camera Alert Monitoring -->
            <script>
                var state_monitor = new EventSource("/state_info");
                state_monitor.onmessage = function(event) {
                    data = event.data.split("&&&");
                    camera = data[0];
                    alert_code = data[1];
                    message_template = `Camera ${camera} found a person that`;
                    if (alert_code == 0) {
                        alert_message = message_template + "does not have a badge"
                    } 
                    else if (alert_code == 1) {
                        alert_message = message_template + "is in a restricted area"
                    }
                    else if (alert_code == 2) {
                        alert_message = message_template + "might have a badge but not a valid SBP one"
                    }
                    else {
                        alert_message = "test"
                    };

                    alert_message_text.innerHTML = alert_message;
                    
                    var alert_div = document.createElement('div');
                        alert_div.className = 'alert alert-danger';
                        alert_div.role = 'alert';
                        alert_div.id = `${camera}_alert`;
                    var message_div = document.createElement('div');
                        message_div.className = 'message';
                    var message_title = document.createElement('strong');
                        message_title.innerHTML = 'Holy Guacamole: &nbsp;';
                    var message_body = document.createElement('weak');
                        message_body.innerHTML = alert_message;
                    var del_button = document.createElement('button');
                        del_button.type = 'button';
                        del_button.class = 'close';
                        del_button.data_dismiss = 'alert';
                        del_button.aria_label = 'Close';
                    var span = document.createElement('span');
                        span.aria_hidden = 'true';
                        span.innerHTML = '&times;';
                    
                    alert_div.appendChild(message_div);
                    alert_div.appendChild(del_button);
                    message_div.appendChild(message_title);
                    message_div.appendChild(message_body);
                    del_button.appendChild(span);
                    
                    document.getElementById('content').appendChild(alert_div);
                    alert('done')
                    
                }
            </script>

            






<div class=wrapper>




          <!-- Sidebar -->
            <nav id="sidebar">
                <div class="sidebar-header">
                    <h3>ID Badge Detector</h3>
                </div>
        
                <ul class="list-unstyled components">
                    <p>Schuberg Philis</p>
                    <li class="active">
                        <a href="#camerasSubmenu" data-toggle="collapse" aria-expanded="false" class="dropdown-toggle">
                            <i class="fas fa-video"></i>
                            cameras</a>
                        <ul class="collapse list-unstyled" id="camerasSubmenu">
                            <li>
                                <a href="templates/carousel.html">Camera 1</a>
                            </li>
                            <li>
                                <a href="#2">Camera 2</a>
                            </li>
                            <li>
                                <a href="#3">Camera 3</a>
                            </li>
                        </ul>
                    </li>
                    <li>
                        <a href="#settingsSubmenu" data-toggle="collapse" aria-expanded="false" class="dropdown-toggle">
                            <i class="fas fa-cogs"></i>
                            settings</a>
                        <ul class="collapse list-unstyled" id="settingsSubmenu">
                            <li>
                                <p>Buffer</p>
                                <div class="slidecontainer"> 
                                    <input type="range" min="1" max="10" value="1" class="slider" id="buffer_range">
                                    <p id="buffervalue"></p>
                                </div>
                            </li>
                            <li>
                               <p>Object life time</p>
                               <input type="range" min="1" max="10" value="1" class="slider" id="lifetime_range">
                               <p id="lifetimevalue"></p>
                            </li>
                            <li>
                                <p>Max badge check count</p>
                                <input type="range" min="1" max="10" value="1" class="slider" id="mbcc_range">
                                <p id="mbccvalue"></p>
                            </li>
                        </ul>
                    </li>
                    <li>
                        <a href="Locations">
                            <i class="fas fa-map"></i>
                            Camera Locations
                        </a>
                    </li>
                    <li>
                        <a href="#systemInfo" data-toggle="collapse" aria-expanded="false" class="dropdown-toggle">
                            <i class="fas fa-video"></i>
                            System Info</a>
                        <ul class="collapse list-unstyled" id="systemInfo">
                            <li>
                                <p>cpu usage</p>
                                <div class="progress" style="width: 95%; margin: 5px;" >
                                    <div class="progress-bar bg-info" role="progressbar" aria-valuenow="0" aria-valuemin="0" aria-valuemax="100" style="width: 0%" id="cpu_usage">
                                        <span class="progress-bar-label" id="cpu_usage_label">0%</span>
                                    </div>
                                </div>
                            </li>
                            <li>
                                <p>ram usage</p>
                                <div class="progress" style="width: 95%; margin: 5px;" >
                                    <div class="progress-bar bg-info" role="progressbar" aria-valuenow="0" aria-valuemin="0" aria-valuemax="100" style="width: 0%" id="ram_usage">
                                        <span class="progress-bar-label" id="ram_usage_label">0%</span>
                                    </div>
                                </div>
                            </li>
                        </ul>
                    </li>
                    
                </ul>
            </nav>

                          <!--Content-->


<div id="content">    
    <nav class="navbar navbar-expand-lg ">
          <div class="container-fluid">
        <button type="button" id="sidebarCollapse" class="btn btn-info" >
            <i class="fas fa-align-left"></i>
            <span>Menu</span>
        </button>
        </div>
        
    </nav>

    

    {% block body %}{% endblock %}
</div> 
          


</div>


<!-- Sidebar interactive -->
    <script>$(document).ready(function () {
    
        $('#sidebarCollapse').on('click', function () {
            $('#sidebar').toggleClass('active');
          });
      });</script>

<!-- Sliders -->


        <script>
        var slider = document.getElementById("buffer_range");
        
        slider.onchange = function() {
        newvalue_buffer=this.value;
} 
        </script>

        <script>
        var slider = document.getElementById("lifetime_range");
            
        slider.onchange = function() {
        newvalue_lifetime = this.value;
        }
        </script>

        <script>
        var slider = document.getElementById("mbcc_range");

            
        slider.onchange = function() {
        newvalue_mbcc =this.value;
        }
        </script>

<!-- slider event listener -->

<script>
    document.getElementById("buffer_range").addEventListener("change", function(){
        document.getElementById("buffervalue").innerHTML = newvalue_buffer;
    });
</script>

<script>
    document.getElementById("lifetime_range").addEventListener("change", function(){
        document.getElementById("lifetimevalue").innerHTML = newvalue_lifetime;
    });
</script>
<script>
    document.getElementById("mbcc_range").addEventListener("change", function(){
    document.getElementById("mbccvalue").innerHTML = newvalue_mbcc;
});
</script>








    

</body>
